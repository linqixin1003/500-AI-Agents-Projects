# Android 客户端快速运行指南

## ✅ 当前状态：可以运行！

Android 客户端的基础配置已完成，**可以编译和运行**。

---

## 🚀 快速运行步骤

### 1. 打开项目

在 Android Studio 中打开 `diabeat-android` 目录

### 2. 同步 Gradle

- 点击 "Sync Project with Gradle Files" 🔄
- 等待依赖下载完成（首次可能需要几分钟）

### 3. 配置 API 地址（重要！）

编辑 `app/src/main/res/values/config.xml`：

**如果使用 Android 模拟器**：
```xml
<string name="api_base_url">http://10.0.2.2:8000</string>
```

**如果使用真机**：
```xml
<string name="api_base_url">http://192.168.1.xxx:8000</string>
```
（替换为你的电脑 IP 地址，查看方法：`ifconfig` 或 `ipconfig`）

### 4. 启动服务器（必需）

```bash
cd diabeat-server
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 5. 运行应用

- 连接 Android 设备或启动模拟器
- 点击 Android Studio 的 "Run" 按钮 ▶️

---

## ✅ 已修复的问题

### 1. MainActivity.kt ✅
- **问题**：AndroidManifest.xml 声明了 MainActivity，但文件不存在
- **解决**：已创建 `app/src/main/kotlin/com/diabeat/ui/MainActivity.kt`

### 2. 主题文件 ✅
- **问题**：缺少主题文件
- **解决**：已创建 `Theme.kt`, `Color.kt`, `Type.kt`, `themes.xml`

### 3. CameraScreen 调用 ✅
- **问题**：CameraScreen 需要参数，但调用时未传参
- **解决**：已修复 MainActivity 中的调用

---

## 📱 可以使用的功能

### ✅ 已实现

1. **基础 UI**
   - 应用可以启动
   - 显示相机界面
   - 主题和样式正常

2. **相机功能**
   - 相机预览
   - 拍照功能
   - 权限处理

3. **网络请求框架**
   - Retrofit 已配置
   - API Service 已定义
   - Token 管理已实现

### ⚠️ 部分实现

1. **用餐记录界面**
   - UI 已创建
   - 需要完善网络请求逻辑

2. **胰岛素记录界面**
   - UI 已创建
   - 需要完善网络请求逻辑

---

## ⚠️ 注意事项

### 1. Firebase 配置（可选）

`google-services.json` 当前是占位符。

**如果不需要推送通知**：
- 可以暂时使用，不影响其他功能

**如果需要推送通知**：
- 需要在 Firebase Console 创建项目
- 下载真实的 `google-services.json`
- 替换 `app/google-services.json`

### 2. API 服务器地址

**必须配置正确的服务器地址**，否则无法调用 API。

**查看电脑 IP 地址**：
```bash
# Mac/Linux
ifconfig | grep "inet "

# Windows
ipconfig
```

**模拟器特殊地址**：
- Android 模拟器访问本地服务器使用：`http://10.0.2.2:8000`

---

## 🧪 测试运行

### 编译测试

```bash
cd diabeat-android
./gradlew assembleDebug
```

如果编译成功，说明项目配置正确 ✅

### 运行测试

1. **启动应用**
   - 应该能看到相机界面

2. **测试相机**
   - 点击拍照按钮
   - 应该能拍照

3. **测试网络请求**
   - 需要先启动服务器
   - 测试 API 调用

---

## 📋 运行检查清单

### 必需项

- [x] MainActivity.kt 已创建 ✅
- [x] 主题文件已创建 ✅
- [x] Gradle 配置完整 ✅
- [x] AndroidManifest.xml 配置正确 ✅
- [ ] API 服务器地址已配置 ⚠️
- [ ] 服务器已启动 ⚠️

### 可选项

- [ ] Firebase 已配置（推送通知）
- [ ] 所有 UI 界面已完善

---

## 🎯 总结

### ✅ 可以运行

**基础功能**：
- ✅ 应用可以编译和运行
- ✅ 可以显示 UI 界面
- ✅ 相机功能可用
- ✅ 网络请求框架已就绪

**需要配置**：
- ⚠️ API 服务器地址（必需）
- ⚠️ Firebase 配置（可选）

### 🚀 下一步

1. **配置 API 地址**（必需）
2. **启动服务器**（必需）
3. **运行应用测试**

---

**详细说明**：参考 `运行状态检查.md`

