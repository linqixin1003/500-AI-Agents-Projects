# DiabEat AI å¯åŠ¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
cd diabeat-server

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
# venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### ç¬¬äºŒæ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `config/.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://diabeat:diabeat123@localhost:5432/diabeat

# JWT é…ç½®ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰
SECRET_KEY=your-secret-key-change-in-production

# AI é…ç½®ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼‰
OPENAI_API_KEY=your-openai-key
DASHSCOPE_API_KEY=your-dashscope-api-key

# AWS S3 é…ç½®ï¼ˆå·²é…ç½®ï¼‰
AWS_ACCESS_KEY_ID=AKIAW5WU5C4HN6FSSOFC
AWS_SECRET_ACCESS_KEY=UP61KnmqnaNSip0BBij/5HW7taNtyeb3ArupsDR
AWS_REGION=us-east-2
AWS_S3_BUCKET=diabeat-ai-images
S3_URL=https://diabeat-ai-images.s3.us-east-2.amazonaws.com

# ç¯å¢ƒé…ç½®
ENVIRONMENT=dev
HOST=localhost:8000
```

### ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æ•°æ®åº“

```bash
# å¯åŠ¨ PostgreSQL
docker-compose up -d db

# ç­‰å¾…æ•°æ®åº“å¯åŠ¨ï¼ˆçº¦10ç§’ï¼‰
sleep 10
```

### ç¬¬å››æ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“

```bash
# è®¾ç½®æ•°æ®åº“è¿æ¥
export DATABASE_URL="postgresql://diabeat:diabeat123@localhost:5432/diabeat"

# è¿è¡Œåˆå§‹åŒ–è„šæœ¬
./scripts/init_db.sh
```

### ç¬¬äº”æ­¥ï¼šæµ‹è¯• S3 é…ç½®ï¼ˆå¯é€‰ï¼‰

```bash
# æµ‹è¯• S3 è¿æ¥
python test_s3_config.py
```

### ç¬¬å…­æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ FastAPI æœåŠ¡
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### ç¬¬ä¸ƒæ­¥ï¼šéªŒè¯æœåŠ¡

1. **å¥åº·æ£€æŸ¥**ï¼š
   ```bash
   curl http://localhost:8000/health
   ```

2. **API æ–‡æ¡£**ï¼š
   æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000/docs

---

## ğŸ“‹ å¯åŠ¨æ£€æŸ¥æ¸…å•

- [ ] å·²å®‰è£… Python 3.10+
- [ ] å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆ`pip install -r requirements.txt`ï¼‰
- [ ] å·²åˆ›å»º `config/.env` æ–‡ä»¶
- [ ] å·²é…ç½® `DATABASE_URL`
- [ ] å·²é…ç½® `SECRET_KEY`ï¼ˆä¿®æ”¹é»˜è®¤å€¼ï¼‰
- [ ] å·²é…ç½® AI API Keyï¼ˆOPENAI æˆ– DASHSCOPEï¼‰
- [ ] å·²å¯åŠ¨æ•°æ®åº“ï¼ˆ`docker-compose up -d db`ï¼‰
- [ ] å·²åˆå§‹åŒ–æ•°æ®åº“ï¼ˆ`./scripts/init_db.sh`ï¼‰
- [ ] å·²æµ‹è¯• S3 é…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] æœåŠ¡å·²å¯åŠ¨ï¼ˆ`uvicorn app.main:app --reload`ï¼‰

---

## ğŸ§ª æµ‹è¯• API

### 1. ç”¨æˆ·æ³¨å†Œ

```bash
curl -X POST "http://localhost:8000/api/users/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "password123",
    "diabetes_type": "type1",
    "name": "Test User"
  }'
```

### 2. ç”¨æˆ·ç™»å½•

```bash
curl -X POST "http://localhost:8000/api/users/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=test@example.com&password=password123"
```

ä¿å­˜è¿”å›çš„ `access_token`ã€‚

### 3. è®¾ç½®ç”¨æˆ·å‚æ•°

```bash
TOKEN="your-access-token-here"
USER_ID="your-user-id-here"

curl -X POST "http://localhost:8000/api/users/${USER_ID}/parameters" \
  -H "Authorization: Bearer ${TOKEN}" \
  -H "Content-Type: application/json" \
  -d '{
    "isf": 2.5,
    "icr": 10.0,
    "target_bg_low": 4.0,
    "target_bg_high": 7.8
  }'
```

### 4. æµ‹è¯•é£Ÿç‰©è¯†åˆ«

```bash
curl -X POST "http://localhost:8000/api/food/recognize" \
  -H "Authorization: Bearer ${TOKEN}" \
  -F "image=@food.jpg"
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦è¿è¡Œ
docker ps | grep postgres

# æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
echo $DATABASE_URL

# é‡å¯æ•°æ®åº“
docker-compose restart db
```

### é—®é¢˜ 2ï¼šæ¨¡å—å¯¼å…¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®ä¿åœ¨è™šæ‹Ÿç¯å¢ƒä¸­
source venv/bin/activate

# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### é—®é¢˜ 3ï¼šS3 è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥é…ç½®
python test_s3_config.py

# æ£€æŸ¥è®¿é—®å¯†é’¥æ˜¯å¦æ­£ç¡®
# æ£€æŸ¥å­˜å‚¨æ¡¶åç§°å’ŒåŒºåŸŸæ˜¯å¦æ­£ç¡®
```

### é—®é¢˜ 4ï¼šç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä½¿ç”¨å…¶ä»–ç«¯å£
uvicorn app.main:app --reload --port 8001

# æˆ–åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -ti:8000 | xargs kill -9
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´é…ç½®æŒ‡å—](./docs/CONFIGURATION_GUIDE.md)
- [API ä½¿ç”¨ç¤ºä¾‹](./API_USAGE_EXAMPLES.md)
- [é¡¹ç›®å®ŒæˆæŠ¥å‘Š](./PROJECT_COMPLETION.md)

---

**æœ€åæ›´æ–°**ï¼š2025-11-06

